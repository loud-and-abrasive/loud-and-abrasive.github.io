<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Can A Linux Docker Swarm Run on Windows Hosts? |  Loud &amp; Abrasive: Patrick McVeety-Mill</title>
<link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.png" >

<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Bungee+Shade&family=Montserrat+Alternates&family=Montserrat:wght@300&family=Vibur&display=swap" rel="stylesheet"> 
<script src="https://kit.fontawesome.com/69fa8fd1fe.js" crossorigin="anonymous"></script>

<link rel="stylesheet" href="/assets/main.css">
<link rel="stylesheet" href="/assets/syntax.css">

<link rel="alternate" type="application/atom+xml" title="Loud &amp; Abrasive: Patrick McVeety-Mill" href="/feed.xml"/>
<link rel="alternate" type="application/rss+xml"  title="Loud &amp; Abrasive: Patrick McVeety-Mill" href="/feed.xml"> 

<script>
  window.backOrHome = function() {
    if(window.history.length <= 1){
      window.location.replace('/')
    } else{
      history.back();
    }
  };
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-49372703-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-49372703-1');
</script>



<!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v3.9.1" />
<meta property="og:title" content="Can A Linux Docker Swarm Run on Windows Hosts?" />
<meta name="author" content="Patrick McVeety-Mill" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="TL,DR: Not Yet in Production I am currently working on a failover orchestration for a small system of servers running a medium number of applications. Most of those, and their supporting infrastructures, are packaged and deployed using Docker. Container orchestration tools like Docker Swarm and Kubernetes have some righteous features like automatic internal DNS, service discovery, routing, and system-self-healing that make failing over when a host fails a breeze to set up. The only trick is, our hosts are Windows servers (Windows 10 IoT to be specific) which aren’t particularly known for playing nice with Docker. Can we have it our way? Come with me on my journey to find out!" />
<meta property="og:description" content="TL,DR: Not Yet in Production I am currently working on a failover orchestration for a small system of servers running a medium number of applications. Most of those, and their supporting infrastructures, are packaged and deployed using Docker. Container orchestration tools like Docker Swarm and Kubernetes have some righteous features like automatic internal DNS, service discovery, routing, and system-self-healing that make failing over when a host fails a breeze to set up. The only trick is, our hosts are Windows servers (Windows 10 IoT to be specific) which aren’t particularly known for playing nice with Docker. Can we have it our way? Come with me on my journey to find out!" />
<link rel="canonical" href="http://loudandabrasive.com/can-a-linux-docker-swarm-run-on-windows-hosts" />
<meta property="og:url" content="http://loudandabrasive.com/can-a-linux-docker-swarm-run-on-windows-hosts" />
<meta property="og:site_name" content="Loud &amp; Abrasive: Patrick McVeety-Mill" />
<meta property="og:image" content="http://loudandabrasive.com/assets/default-card-image.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-06-15T14:42:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://loudandabrasive.com/assets/default-card-image.jpg" />
<meta property="twitter:title" content="Can A Linux Docker Swarm Run on Windows Hosts?" />
<meta name="twitter:site" content="@loudandabrasive" />
<meta name="twitter:creator" content="@loudandabrasive" />
<script type="application/ld+json">
{"description":"TL,DR: Not Yet in Production I am currently working on a failover orchestration for a small system of servers running a medium number of applications. Most of those, and their supporting infrastructures, are packaged and deployed using Docker. Container orchestration tools like Docker Swarm and Kubernetes have some righteous features like automatic internal DNS, service discovery, routing, and system-self-healing that make failing over when a host fails a breeze to set up. The only trick is, our hosts are Windows servers (Windows 10 IoT to be specific) which aren’t particularly known for playing nice with Docker. Can we have it our way? Come with me on my journey to find out!","url":"http://loudandabrasive.com/can-a-linux-docker-swarm-run-on-windows-hosts","@type":"BlogPosting","image":"http://loudandabrasive.com/assets/default-card-image.jpg","headline":"Can A Linux Docker Swarm Run on Windows Hosts?","dateModified":"2021-06-15T14:42:00+00:00","datePublished":"2021-06-15T14:42:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://loudandabrasive.com/can-a-linux-docker-swarm-run-on-windows-hosts"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://loudandabrasive.com/assets/loudandalogo.png"},"name":"Patrick McVeety-Mill"},"author":{"@type":"Person","name":"Patrick McVeety-Mill"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>
  <body>

    <header class="top">
  <div class="title-container">
  <span class="subtitle">Patrick McVeety-Mill:</span>
  <h1 class="title">
    <a href="/">Loud &amp; Abrasive</a>
  </h1>
</div>

<nav>
  <input id="nav-toggle-check" name="nav-toggle-check" type="checkbox" class="nav-toggle" />
  <label for="nav-toggle-check" class="nav-toggle">
    <i class="fas fa-bars"></i>
  </label>

  <ul class="page-list">
    
      
      
        <li class="nav-link-vermilion">
          <a href="/tech/index.html">
            Tech <i class="fas fa-code-branch"></i>
          </a>
        </li>
      
    
      
      
        <li class="nav-link-orange">
          <a href="/life/index.html">
            Life <i class="fas fa-hiking"></i>
          </a>
        </li>
      
    
      
      
        <li class="nav-link-citron">
          <a href="/arts/index.html">
            Arts <i class="fas fa-paint-brush"></i>
          </a>
        </li>
      
    
      
      
        <li class="nav-link-teal">
          <a href="/about/">
            About <i class="fas fa-bullhorn"></i>
          </a>
        </li>
      
    
    <li class="nav-link-charcoal">
      <a href="/feed.xml" target="_blank" class="hover-charcoal">Subscribe <i class="fas fa-rss"></i></a>
    </li>
  </ul>

  <hr class="stripes mobile-stripes" />
</nav>

</header>
<hr class="stripes top-stripes" />

<main class="site-content" aria-label="Content">
  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Can A Linux Docker Swarm Run on Windows Hosts?</h1>
    <div class="post-meta">
      <div>
        <span class="post-category vermilion">DevOps</span>
        published
        <time datetime="2021-06-15T14:42:00+00:00" itemprop="datePublished">
          
          Jun 15, 2021
        </time>
      </div>
      
        regarding docker | swarm | linux | windows
      
    </div>
  </header>

  <div class="post-content" aria-label="Content" itemprop="articleBody">
    <h2 id="tldr-not-yet-in-production">TL,DR: Not Yet in Production</h2>

<p>I am currently working on a failover orchestration for a small system of servers running a medium number of applications. Most of those, and their supporting infrastructures, are packaged and deployed using Docker. Container orchestration tools like Docker Swarm and Kubernetes have some righteous features like automatic internal DNS, service discovery, routing, and system-self-healing that make failing over when a host fails a breeze to set up. The only trick is, our hosts are <em>Windows</em> servers (Windows 10 IoT to be specific) which aren’t particularly known for playing nice with Docker. Can we have it our way? Come with me on my journey to find out!</p>

<!--more-->

<h2 id="what-we-need">What We Need</h2>

<p>Let’s start by taking inventory: We have a more than a handful of Docker Linux containers, including applications built in-house by different teams, supporting third-party apps, as well as infrastructure like databases and queues. We have a handful Windows 10 machines we’re looking run them on, ideally joined together as <a href="https://docs.docker.com/engine/swarm/">Docker Swarm Mode</a> “nodes” to get those nice features mentioned above.</p>

<p>All together, that means we need these features in conjunction with each other:</p>

<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />multi-node swarm</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />windows hosts</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />linux containers</li>
</ul>

<h2 id="rage-against-docker-machine">Rage Against Docker Machine</h2>

<p>To figure out if we can get all those features at the same time, we’ll start by going to the Docker docs. Here in the <a href="https://docs.docker.com/engine/swarm/swarm-tutorial/#use-docker-desktop-for-mac-or-docker-desktop-for-windows">Getting started</a> tutorial, it looks like we can’t do multi-node on Windows without <em>docker machine</em>:</p>

<blockquote>
  <p>Alternatively, install the latest Docker Desktop for Mac or Docker Desktop for Windows application on one computer. You can test both single-node and multi-node swarm from this computer, but you need to use Docker Machine to test the multi-node scenarios.</p>
</blockquote>

<p>There’s not a whole lot of other information on the surface of how that works. We can find that <a href="http://docs.docker.oeynet.com/machine/overview/">Docker Machine</a> is the cli tool for remote Docker management, either on cloud or local VMs or manually joining to hosts by <code class="language-plaintext highlighter-rouge">ssh</code>. A bit deeper in there’s a guide for the Swarm tutorial setup with <a href="http://docs.docker.oeynet.com/machine/drivers/hyper-v/">Docker Machine and Hyper-V</a>. After combing through it all, we can conclude <code class="language-plaintext highlighter-rouge">machine</code> allows us to remotely manage <em>Linux</em> machines running the Docker Engine.</p>

<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />multi-node swarm</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><del>windows hosts</del> Windows hosts <em>calling Linux hosts</em></li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />linux containers</li>
</ul>

<h2 id="docker-engine-on-windows-desktop">Docker [Engine] on Windows [Desktop]</h2>

<p>The documentation on Docker Machine included an interesting bit that had me wanting to learn more about Docker and Windows in general.</p>

<blockquote>
  <p>Machine was the only way to run Docker on Mac or Windows previous to Docker v1.12.</p>
</blockquote>

<p>We know “Docker Desktop” is a bundle of cli tools, Kubernetes, and most importantly the <em>Docker Engine</em> which is the critical piece for working with containers on the Docker daemon. If we check out the page for <a href="https://docs.docker.com/engine/install/#server">installing the Docker Engine</a> the only operating systems listed under “Server” are Linux varieties. And yet somehow folks have hosted Windows containers, right? Searching for “docker windows server” can get us to the <a href="https://www.docker.com/products/windows-containers">Windows Containers product page</a> and a little more digging in the docs can get us to installation instructions for <a href="https://docker-docs.netlify.app/install/windows/docker-ee/">Docker Engine Enterprise on Windows Server</a>.</p>

<p>This is where the documentation starts getting a little fuzzy. It doesn’t say anywhere explicitly that these are Windows containers, only, but they most likely are. We also see some references to “Docker for Windows” but all links are updated to redirect to the newer “Docker Desktop for Windows.” There’s also “Swarm” ambiguity in some Stack Overflow questions, blogs, and guides, between the new Swarm mode and <a href="https://github.com/docker/classicswarm">Swarm Classic</a>.</p>

<p>A wider search of the internet yields a promising <a href="https://www.youtube.com/watch?v=ZfMV5JmkWCY">video series from Microsoft</a> on how to run a Swarm of both Linux and Windows hosts and containers. There we can see that Docker Engine Enterprise can host Swarms on Windows Servers, but only Windows containers can run on the Windows nodes. Linux containers can be added to the Swarm, but require a Linux host to run on. Once again we come up short.</p>

<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />multi-node swarm</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />windows hosts</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><del>linux containers</del> only run on Linux nodes</li>
</ul>

<h2 id="coming-soon-to-a-windows-server-near-you">Coming Soon(?) to a Windows Server Near You</h2>

<p>That same wider search for “windows server linux containers” yields a <a href="https://blog.eldernode.com/run-linux-containers-on-windows-server/">couple</a> <a href="https://www.altaro.com/msp-dojo/linux-containers-windows-server-2019/">tutorials</a> on exactly what we’re looking for: running <strong>Linux</strong> containers on <strong>Windows</strong> server 2019, using Docker Enterprise which supports <strong>Swarm Mode</strong>. Fantastic! However, the module is in preview.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Install-Package</span><span class="w"> </span><span class="nx">Docker</span><span class="w"> </span><span class="nt">-ProviderName</span><span class="w"> </span><span class="nx">DockerProvider</span><span class="w"> </span><span class="nt">-RequiredVersion</span><span class="w"> </span><span class="nx">preview</span><span class="w">
</span></code></pre></div></div>

<p>Software in preview often works great! But if you’re like me, you’d be nervous to use it in production. And unfortunately there’s no indication of when it will be ready for primetime. Even <a href="https://mountainss.wordpress.com/2020/03/31/docker-linux-container-running-on-windows-server-2019-winserv-docker-containers/">slightly newer articles</a> include turning on experimental features within Docker. I guess we omitted an important implicit requirement from our list:</p>

<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />multi-node swarm</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />windows hosts</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />linux containers</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />production ready</li>
</ul>

<p>Maybe next time, friends. Till then, if you’re planning on using container orchestration, plan on hosting it in Linux!</p>

  </div>

  <a class="outline-link" href="javascript:window.backOrHome()">
    <i class="fas fa-chevron-left vermilion"><i class="fas fa-chevron-left orange"></i></i><i class="fas fa-chevron-left citron"></i><i class="fas fa-chevron-left teal"></i>
    Return
  </a>

  
</article>

</main>


    <hr class="footer-stripes" />

<footer class="site-footer">
  <span class="copy">&copy; 2021 Loud & Abrasive & Co.</span>
  <ul class="social-links">
    
      
      
      <li><a href="https://twitter.com/loudandabrasive" title="Twitter" target="_blank"><i class="fab fa-twitter hover-vermilion"></i></a></li>
      
    
      
      
      <li><a href="https://linkedin.com/in/pmcvtm" title="LinkedIn" target="_blank"><i class="fab fa-linkedin-in hover-orange"></i></a></li>
      
    
      
      
      <li><a href="https://github.com/pmcvtm" title="Github" target="_blank"><i class="fab fa-github hover-citron"></i></a></li>
      
    
      
      
      <li><a href="https://bandcamp.com/loudandabrasive" title="Bandcamp" target="_blank"><i class="fab fa-bandcamp hover-teal"></i></a></li>
      
    
      
      
      <li><a href="https://letterboxd.com/loudandabrasive/" title="Letterboxd" target="_blank"><i class="fab fa-pied-piper hover-charcoal"></i></a></li>
      
    
      
      
      <li><a href="https://untappd.com/user/loudandabrasive" title="Untappd" target="_blank"><i class="fab fa-untappd hover-vermilion"></i></a></li>
      
    
      
      
      <li><a href="https://goodreads.com/loudandabrasive/" title="Goodreads" target="_blank"><i class="fab fa-goodreads-g hover-orange"></i></a></li>
      
    
      
      
      <li><a href="https://instagram.com/loudandabrasive" title="Instagram" target="_blank"><i class="fab fa-instagram hover-citron"></i></a></li>
      
    
    <li><a class="rss" title="Subscribe" target="_blank" href="/feed.xml"><i class="fas fa-rss"></i></a></li>
  </ul>
</footer>


  </body>
</html>
